---
# Grafana Configuration
# Visualization and dashboarding platform

# ========================================
# Grafana Version
# ========================================
grafana_version: "10.2.3"

# ========================================
# Grafana Connection
# ========================================
grafana_listen_address: "0.0.0.0"
grafana_port: 3000
grafana_domain: "{{ ansible_host }}"
grafana_root_url: "http://{{ grafana_domain }}:{{ grafana_port }}"

# ========================================
# Grafana Admin
# ========================================
grafana_admin_user: admin
grafana_admin_password: "{{ vault_grafana_admin_password }}"
grafana_admin_email: admin@localhost

# ========================================
# Grafana Data Storage
# ========================================
grafana_data_dir: /var/lib/grafana
grafana_logs_dir: /var/log/grafana
grafana_plugins_dir: /var/lib/grafana/plugins

# ========================================
# Grafana Database
# ========================================
# Use SQLite for simplicity (can upgrade to MariaDB later)
grafana_database_type: sqlite3
grafana_database_path: /var/lib/grafana/grafana.db

# For MariaDB (optional):
# grafana_database_type: mysql
# grafana_database_host: localhost:3306
# grafana_database_name: grafana
# grafana_database_user: grafana
# grafana_database_password: "{{ vault_grafana_db_password }}"

# ========================================
# Grafana Security
# ========================================
grafana_disable_gravatar: true
grafana_cookie_secure: false  # Set to true if using HTTPS
grafana_cookie_samesite: lax
grafana_allow_embedding: false

# Anonymous access
grafana_auth_anonymous_enabled: false

# Firewall rules
grafana_firewall_allowed_ips:
  - 127.0.0.1/32
  # Add your admin IP for web access
  # - "203.0.113.50/32"

# ========================================
# Grafana Data Sources
# ========================================
grafana_datasources:
  - name: Prometheus
    type: prometheus
    access: proxy
    url: "http://localhost:{{ prometheus_port }}"
    is_default: true
    editable: false

# ========================================
# Grafana Dashboards
# ========================================
grafana_dashboards_enabled: true

# Pre-configured dashboards (by ID from grafana.com)
grafana_default_dashboards:
  # Node Exporter Full (System metrics)
  - name: node-exporter-full
    enabled: true
    dashboard_id: 1860
    revision: 1
    datasource: Prometheus

  # Redis Dashboard (works with Valkey)
  - name: valkey-dashboard
    enabled: true
    dashboard_id: 7362
    revision: 1
    datasource: Prometheus

  # MySQL/MariaDB Dashboard
  - name: mariadb-dashboard
    enabled: true
    dashboard_id: 7362
    revision: 1
    datasource: Prometheus

  # Nginx Dashboard
  - name: nginx-dashboard
    enabled: false
    dashboard_id: 12708
    revision: 1
    datasource: Prometheus

# ========================================
# Grafana Plugins
# ========================================
grafana_plugins:
  - grafana-piechart-panel
  - grafana-clock-panel

# ========================================
# Grafana Alerting
# ========================================
grafana_alerting_enabled: false  # Enable later if needed

# ========================================
# Grafana SMTP (for email alerts)
# ========================================
grafana_smtp_enabled: false
# grafana_smtp_host: smtp.gmail.com:587
# grafana_smtp_user: alerts@example.com
# grafana_smtp_password: "{{ vault_grafana_smtp_password }}"
# grafana_smtp_from_address: alerts@example.com

# ========================================
# Grafana Backup
# ========================================
grafana_backup_enabled: true
grafana_backup_schedule: "0 5 * * *"  # Daily at 5 AM
grafana_backup_retention_days: 7
grafana_backup_dir: /var/backups/grafana

# ========================================
# Grafana Logging
# ========================================
grafana_log_level: info
grafana_log_mode: console file

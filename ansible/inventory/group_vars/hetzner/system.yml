---
# Hetzner System Configuration
# Kernel parameters, sysctl, system hardening

# ========================================
# Kernel Parameters (sysctl)
# ========================================
sysctl_config:
  # IP Forwarding (disable unless needed)
  net.ipv4.ip_forward: 0
  net.ipv6.conf.all.forwarding: 0

  # SYN flood protection
  net.ipv4.tcp_syncookies: 1
  net.ipv4.tcp_syn_retries: 2
  net.ipv4.tcp_synack_retries: 2
  net.ipv4.tcp_max_syn_backlog: 4096

  # IP spoofing protection
  net.ipv4.conf.all.rp_filter: 1
  net.ipv4.conf.default.rp_filter: 1

  # Ignore ICMP redirects
  net.ipv4.conf.all.accept_redirects: 0
  net.ipv4.conf.default.accept_redirects: 0
  net.ipv4.conf.all.secure_redirects: 0
  net.ipv4.conf.default.secure_redirects: 0
  net.ipv6.conf.all.accept_redirects: 0
  net.ipv6.conf.default.accept_redirects: 0

  # Don't send ICMP redirects
  net.ipv4.conf.all.send_redirects: 0
  net.ipv4.conf.default.send_redirects: 0

  # Ignore ICMP ping requests (disabled for monitoring)
  net.ipv4.icmp_echo_ignore_all: 0

  # Ignore Directed pings
  net.ipv4.icmp_echo_ignore_broadcasts: 1

  # Accept source routing
  net.ipv4.conf.all.accept_source_route: 0
  net.ipv6.conf.all.accept_source_route: 0

  # Log Martians
  net.ipv4.conf.all.log_martians: 1

  # Kernel hardening
  kernel.dmesg_restrict: 1
  kernel.kptr_restrict: 2
  kernel.yama.ptrace_scope: 1

  # File system hardening
  fs.suid_dumpable: 0
  fs.protected_hardlinks: 1
  fs.protected_symlinks: 1

# ========================================
# Kernel Hardening
# ========================================
kernel_hardening_enabled: true

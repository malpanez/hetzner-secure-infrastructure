---
# Overrides for production environment (labels.environment = "prod")

# Enforce SSH 2FA with explicit break-glass user
ssh_2fa_enabled: true
ssh_2fa_break_glass_enabled: true
ssh_2fa_break_glass_users:
  - malpanez

# Only enable 2FA if break-glass users exist and have authorized_keys
ssh_2fa_require_break_glass_ready: true

# Auditd with boot stability fix (audit_backlog_limit=8192 prevents boot hangs)
# FIXED: Now includes audit_backlog_limit to prevent buffer overflow during boot
# Previous issue: audit=1 alone caused boot hangs (buffer overflow before auditd starts)
# Solution: audit_backlog_limit=8192 provides sufficient buffer for boot-time audit messages
security_hardening_auditd_enabled: false
security_hardening_manage_grub: false

# AppArmor GRUB management (safe to enable)
apparmor_manage_grub: true

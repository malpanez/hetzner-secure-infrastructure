---
# Firewall Role - Default Variables
# All variables prefixed with 'firewall_' following Ansible Best Practices

# ========================================
# Installation Configuration
# ========================================

# APT packages
firewall_apt_packages:
  - ufw

# ========================================
# Deployment Control
# ========================================

firewall_enabled: true
firewall_disable_for_batch: false
firewall_relax_idempotence: false

# ========================================
# UFW Default Policies
# ========================================

firewall_default_incoming_policy: deny
firewall_default_outgoing_policy: allow

# ========================================
# UFW Allowed Ports
# ========================================

# Management IP for SSH access restriction
# This should match the IP used in cloud-init and Terraform
firewall_management_ips: "{{ ssh_allowed_ips }}"

firewall_allowed_ports:
  - rule: allow
    port: "22"
    proto: tcp
    from_ip: "{{ firewall_management_ips | first }}"  # SSH restricted to management IP
    comment: "SSH from management IP"
  - rule: allow
    port: "80"
    proto: tcp
    comment: "HTTP"
  - rule: allow
    port: "443"
    proto: tcp
    comment: "HTTPS"

# ========================================
# UFW Rate Limiting
# ========================================

firewall_rate_limit_ssh: true
firewall_rate_limit_attempts: 6
firewall_rate_limit_seconds: 60

# ========================================
# UFW Logging
# ========================================

firewall_logging: "on"  # on, off, low, medium, high, full

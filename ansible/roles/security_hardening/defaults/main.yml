---
# Security Hardening Role - Default Variables

# ========================================
# Feature Toggles
# ========================================

# Kernel hardening
security_hardening_kernel_enabled: true

# Unattended upgrades
security_hardening_unattended_upgrades_enabled: true

# AIDE File Integrity Monitoring
security_hardening_aide_enabled: false

# Auditd Configuration
security_hardening_auditd_enabled: true
security_hardening_manage_grub: true

# USB storage disable
security_hardening_disable_usb_storage: false

# ========================================
# Auditd Configuration
# ========================================

security_hardening_auditd_max_log_file: 8
security_hardening_auditd_max_log_file_action: rotate
security_hardening_auditd_num_logs: 5
security_hardening_auditd_space_left: 75
security_hardening_auditd_space_left_action: email
security_hardening_auditd_admin_space_left: 50
security_hardening_auditd_admin_space_left_action: suspend
security_hardening_auditd_disk_full_action: suspend
security_hardening_auditd_disk_error_action: suspend
security_hardening_auditd_action_mail_acct: root

# ========================================
# Admin Configuration
# ========================================

security_hardening_admin_username: malpanez

# ========================================
# Login Banner Configuration
# ========================================

security_hardening_login_banner_enabled: true
security_hardening_login_banner_text: |
  ################################################################################
  #                                                                              #
  #                        AUTHORIZED ACCESS ONLY                                #
  #                                                                              #
  ################################################################################
  #                                                                              #
  #  This system is the property of Two Minds Trading Infrastructure.           #
  #                                                                              #
  #  NOTICE TO USERS:                                                            #
  #                                                                              #
  #  • Unauthorized access to this system is strictly prohibited and may be      #
  #    prosecuted under applicable computer fraud and abuse laws.                #
  #                                                                              #
  #  • All activities on this system are monitored and logged. By accessing      #
  #    this system, you consent to such monitoring and logging.                  #
  #                                                                              #
  #  • Any unauthorized use, access attempts, or suspicious activities will      #
  #    be reported to the appropriate authorities.                               #
  #                                                                              #
  #  • Users must comply with all applicable security policies and procedures.   #
  #                                                                              #
  #  If you are not an authorized user, disconnect immediately.                  #
  #                                                                              #
  ################################################################################

# ========================================
# Process Accounting
# ========================================

security_hardening_process_accounting_enabled: true

# ========================================
# Additional Hardening Features
# ========================================

# Restrict access to compilers
security_hardening_restrict_compilers: true

# Harden /tmp with separate mount options
security_hardening_harden_tmp: true

# ========================================
# Sysctl Hardening Configuration
# ========================================
# Based on DevSec hardening framework + CIS benchmarks

security_hardening_sysctl_config:
  # Network security - IPv4
  net.ipv4.conf.all.rp_filter: 1
  net.ipv4.conf.default.rp_filter: 1
  net.ipv4.conf.all.accept_redirects: 0
  net.ipv4.conf.default.accept_redirects: 0
  net.ipv4.conf.all.secure_redirects: 0
  net.ipv4.conf.default.secure_redirects: 0
  net.ipv4.conf.all.send_redirects: 0
  net.ipv4.conf.default.send_redirects: 0
  net.ipv4.conf.all.accept_source_route: 0
  net.ipv4.conf.default.accept_source_route: 0
  net.ipv4.conf.all.log_martians: 1
  net.ipv4.conf.default.log_martians: 1
  net.ipv4.icmp_echo_ignore_broadcasts: 1
  net.ipv4.icmp_ignore_bogus_error_responses: 1
  net.ipv4.tcp_syncookies: 1

  # Network security - IPv6
  net.ipv6.conf.all.accept_redirects: 0
  net.ipv6.conf.default.accept_redirects: 0
  net.ipv6.conf.all.accept_source_route: 0
  net.ipv6.conf.default.accept_source_route: 0
  net.ipv6.conf.all.accept_ra: 0
  net.ipv6.conf.default.accept_ra: 0

  # Kernel hardening
  kernel.dmesg_restrict: 1
  kernel.kptr_restrict: 2
  kernel.yama.ptrace_scope: 1
  kernel.kexec_load_disabled: 1
  kernel.sysrq: 0
  kernel.core_uses_pid: 1

  # File system hardening
  fs.protected_hardlinks: 1
  fs.protected_symlinks: 1
  fs.protected_fifos: 1
  fs.protected_regular: 2
  fs.suid_dumpable: 0

# ========================================
# Filesystem Module Blocking
# ========================================
# Disable unused/insecure filesystems

security_hardening_disabled_filesystems:
  - cramfs
  - freevxfs
  - jffs2
  - hfs
  - hfsplus
  - squashfs
  - udf
  - vfat

# ========================================
# Network Protocol Blocking
# ========================================
# Disable insecure network protocols

security_hardening_disabled_network_protocols:
  - dccp
  - sctp
  - rds
  - tipc

# ========================================
# Package Configuration
# ========================================

security_hardening_packages:
  - acct
  - aide
  - apt-listchanges
  - audispd-plugins
  - auditd
  - debsums
  - libpam-pwquality
  - needrestart
  - unattended-upgrades

groups:
  - name: ssl_certificate_alerts
    interval: 6h
    rules:
      - alert: SSLCertificateExpiringSoon
        expr: probe_ssl_earliest_cert_expiry - time() < 86400 * 14
        for: 1h
        labels:
          severity: warning
          service: ssl
        annotations:
          summary: "SSL certificate expiring soon for {{ $labels.instance }}"
          description: "SSL certificate for {{ $labels.instance }} will expire in {{ $value | humanizeDuration }}. Renew it soon!"

      - alert: SSLCertificateExpiring
        expr: probe_ssl_earliest_cert_expiry - time() < 86400 * 7
        for: 1h
        labels:
          severity: critical
          service: ssl
        annotations:
          summary: "SSL certificate expiring in less than 7 days for {{ $labels.instance }}"
          description: "SSL certificate for {{ $labels.instance }} will expire in {{ $value | humanizeDuration }}. Renew it immediately!"

      - alert: SSLCertificateExpired
        expr: probe_ssl_earliest_cert_expiry - time() < 0
        for: 5m
        labels:
          severity: critical
          service: ssl
        annotations:
          summary: "SSL certificate expired for {{ $labels.instance }}"
          description: "SSL certificate for {{ $labels.instance }} has expired! Website is not accessible via HTTPS."

      - alert: SSLCertificateProbeFailure
        expr: probe_success{job="blackbox-ssl"} == 0
        for: 5m
        labels:
          severity: critical
          service: ssl
        annotations:
          summary: "SSL probe failed for {{ $labels.instance }}"
          description: "Cannot probe SSL certificate for {{ $labels.instance }}. Check website availability."

      - alert: WebsiteDown
        expr: probe_success{job="blackbox-http"} == 0
        for: 2m
        labels:
          severity: critical
          service: website
        annotations:
          summary: "Website {{ $labels.instance }} is down"
          description: "Website {{ $labels.instance }} is not responding to HTTP probes for more than 2 minutes."

      - alert: WebsiteHighResponseTime
        expr: probe_http_duration_seconds > 3
        for: 5m
        labels:
          severity: warning
          service: website
        annotations:
          summary: "High response time for {{ $labels.instance }}"
          description: "Website {{ $labels.instance }} is responding in {{ $value }} seconds. Check server performance."

      - alert: WebsiteHTTPStatusError
        expr: probe_http_status_code >= 400
        for: 5m
        labels:
          severity: warning
          service: website
        annotations:
          summary: "HTTP error {{ $value }} for {{ $labels.instance }}"
          description: "Website {{ $labels.instance }} is returning HTTP status code {{ $value }}."

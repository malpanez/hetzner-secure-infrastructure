---
# Promtail Role - Firewall Configuration Tasks

- name: Promtail | Firewall | Allow Promtail HTTP port
  community.general.ufw:
    rule: allow
    port: "{{ promtail_http_listen_port }}"
    proto: tcp
    src: "{{ item }}"
    comment: Promtail HTTP API
  loop: "{{ promtail_firewall_allowed_ips | default([]) }}"
  when:
    - firewall_enabled | default(true)
    - promtail_firewall_allowed_ips is defined
    - promtail_firewall_allowed_ips | length > 0
  tags: [promtail, firewall]

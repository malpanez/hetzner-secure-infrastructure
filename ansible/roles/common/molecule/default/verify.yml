---
- name: Verify
  hosts: all
  become: true
  gather_facts: true

  tasks:
    - name: Check if essential packages are installed
      ansible.builtin.package:
        name:
          - curl
          - wget
          - vim
          - git
        state: present
      check_mode: true
      register: packages_installed
      failed_when: packages_installed.changed

    - name: Check if timezone is set
      ansible.builtin.command: timedatectl show --property=Timezone --value
      register: timezone_check
      changed_when: false
      failed_when: timezone_check.stdout == ""

    - name: Verify system locale is set
      ansible.builtin.command: localectl status
      register: locale_check
      changed_when: false
      failed_when: locale_check.rc != 0

    - name: Display test results
      ansible.builtin.debug:
        msg: "All common role tests passed!"

# SSH 2FA Configuration
# Managed by Ansible - ssh_2fa role
# This file enables two-factor authentication for SSH

# Enable keyboard-interactive for 2FA
KbdInteractiveAuthentication yes
ChallengeResponseAuthentication {{ ssh_2fa_challenge_response_authentication }}

# Enable PAM for 2FA integration
UsePAM yes

# Require both publickey AND keyboard-interactive (2FA)
AuthenticationMethods {{ ssh_2fa_auth_methods }}

# Allow publickey authentication
PubkeyAuthentication {{ ssh_2fa_pubkey_authentication }}

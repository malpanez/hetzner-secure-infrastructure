# ============================================================================
# SSL/TLS Parameters
# ============================================================================
# Include this in server{} blocks that use SSL
#
# Modern, secure SSL/TLS configuration following Mozilla guidelines.
# Optimized for security and performance.
#
# Note: ssl_certificate and ssl_certificate_key must be set in server{} block
# This snippet only contains the SSL parameters.
#
# Reference: https://ssl-config.mozilla.org/
# ============================================================================

# Enable TLS 1.2 and 1.3 only (TLS 1.0/1.1 deprecated due to vulnerabilities)
# TLS 1.2: Compatible with older browsers (iOS 11+, Android 4.4+)
# TLS 1.3: Faster handshake, more secure (95% browser support)
ssl_protocols TLSv1.2 TLSv1.3;

# Cipher suites (prioritize modern, secure ciphers)
# ECDHE: Forward secrecy (past sessions safe if private key stolen)
# AES-GCM: Fast authenticated encryption
# CHACHA20: For mobile devices without AES hardware acceleration
ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384';

# Let client choose cipher (modern best practice)
# Clients can select fastest cipher for their hardware (e.g., CHACHA20 on mobile)
ssl_prefer_server_ciphers off;

# SSL session cache (reuse SSL sessions for better performance)
# 10MB cache = ~40,000 sessions
# Avoids full TLS handshake for returning visitors
ssl_session_cache shared:SSL:10m;
ssl_session_timeout 10m;

# Disable SSL session tickets (security: prevents forward secrecy issues)
ssl_session_tickets off;

# OCSP stapling (optional, improves SSL handshake performance)
# Server fetches certificate revocation status, reduces client lookup time
# Uncomment if you have a valid OCSP responder
# ssl_stapling on;
# ssl_stapling_verify on;
# ssl_trusted_certificate /path/to/chain.pem;
# resolver 1.1.1.1 1.0.0.1 valid=300s;
# resolver_timeout 5s;

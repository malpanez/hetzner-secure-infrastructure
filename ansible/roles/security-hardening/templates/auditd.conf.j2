# Auditd Configuration
# Managed by Ansible - DO NOT EDIT MANUALLY
# Compliance: SOC-2 TSC CC7.2, NIST AU-2/AU-3/AU-4/AU-5/AU-6, FedRAMP AU-2, HIPAA ยง164.312(b), PCI-DSS 10.2

# Local events logging location
log_file = /var/log/audit/audit.log

# Log file rotation
log_format = ENRICHED
log_group = adm
priority_boost = 4
flush = INCREMENTAL_ASYNC
freq = 50
max_log_file = {{ auditd_max_log_file }}
num_logs = {{ auditd_num_logs }}
max_log_file_action = {{ auditd_max_log_file_action }}

# Space management
space_left = {{ auditd_space_left }}
space_left_action = {{ auditd_space_left_action }}
verify_email = yes
action_mail_acct = {{ auditd_action_mail_acct }}
admin_space_left = {{ auditd_admin_space_left }}
admin_space_left_action = {{ auditd_admin_space_left_action }}

# Disk full actions
disk_full_action = {{ auditd_disk_full_action }}
disk_error_action = {{ auditd_disk_error_action }}

# Use auditd's built-in network client
use_libwrap = yes

# Increase rate limit to prevent message loss
# 0 = unlimited
rate_limit = 0

# Make the configuration immutable
# This prevents changes until reboot
enable_krb5 = no

# Name resolution
name_format = hostname
